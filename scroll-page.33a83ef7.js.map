{"mappings":"iiBAAA,I,EAAAA,EAAAC,EAAA,S,iEAMMC,EAAeC,SAASC,cAAc,mBACtCC,EAAYF,SAASC,cAAc,eACnCE,EAAYH,SAASC,cAAc,oBAEnCG,EAAc,IAAI,EAAAC,EAAAC,aAElBC,G,EAAeC,EAAAX,EAAA,CAAAW,EAAAC,GAAAC,MAAA,SAAAC,EAAMC,G,IAIbC,E,yEAHVT,EAAYU,MAAQ,E,kBAGOV,EAAYW,qB,aAA7BF,EAAQG,EAAAC,MAEDC,KAAKC,WAAaf,EAAYgB,SAAShB,EAAYU,MAAI,C,uBAEhEZ,EAAUmB,mBAAmB,aAAa,EAAAC,EAAAC,SAAmBV,EAASK,KAAKM,OAE3EC,EAASC,UAAU1B,SAASC,cAAc,oBAE1C0B,IAEAnB,EAAAoB,GAASC,OAAOC,KAAK,6DAA8D,CACnFC,QAAS,M,2BAKb7B,EAAUmB,mBAAmB,aAAa,EAAAC,EAAAC,SAAmBV,EAASK,KAAKM,OAE3EG,I,kDAGAK,QAAQC,IAAGjB,EAAAkB,I,mEAzBQtB,G,iCA6BrBa,EAAW,IAAIU,sBACjB,SAACC,EAASC,GACFD,EAAQ,GAAGE,gBACf/B,G,GAGJ,CACIgC,KAAM,KACNC,WAAY,QACZC,UAAW,IAIbC,EAAkB,W,MAAGlC,EAAAX,EAAA,CAAAW,EAAAC,GAAAC,MAAA,SAAAC,EAAMC,G,IAOvBC,E,yEANND,EAAM+B,iBAENvC,EAAYwC,MAAQzC,EAAU0C,MAC9BzC,EAAYU,KAAO,E,kBAGIV,EAAYW,qB,UAEC,KAF9BF,EAAQG,EAAAC,MAECC,KAAKM,KAAKsB,OAAY,C,uBAEjCtC,EAAAoB,GAASC,OAAOC,KAAK,4EAErB5B,EAAU6C,UAAY,GAEtBtB,EAASC,UAAU1B,SAASC,cAAc,oBAE1CW,EAAMoC,OAAOC,Q,gCAIVpC,EAASK,KAAKM,KAAKsB,OAAS1C,EAAYgB,UAAQ,C,uBAEnDlB,EAAU6C,WAAY,EAAAzB,EAAAC,SAAmBV,EAASK,KAAKM,MAEvDG,IAEAF,EAASC,UAAU1B,SAASC,cAAc,oBAE1CO,EAAAoB,GAASC,OAAOqB,QAAQ,6DAA8D,CAClFnB,QAAS,M,2BAKb7B,EAAU6C,WAAY,EAAAzB,EAAAC,SAAmBV,EAASK,KAAKM,MAEvDG,IAEAF,EAAS0B,QAAQnD,SAASC,cAAc,oBAExCO,EAAAoB,GAASC,OAAOuB,QAAQ,oBAA4CC,OAAxBxC,EAASK,KAAKC,UAAU,sBAAqB,CACzFY,QAAS,M,kDAITC,QAAQC,IAAGjB,EAAAkB,I,0EA9CctB,G,gCAAT,GAoDlBe,EAAc,WAKhB,OAJiB,IAAInB,EAAA8C,GAAJ,CAAmB,aAAc,CAClDC,aAAc,MACdC,aAAc,K,EAKlBzD,EAAa0D,iBAAiB,SAAUf,E","sources":["src/js/galleryInfiniteScroll.js"],"sourcesContent":["import { UnsplashAPI } from './unsplash-api';\nimport createGalleryCards from '../templates/gallery-card.hbs';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst userInput = document.querySelector('.js-search-input');\n\nconst unsplashAPI = new UnsplashAPI();\n\nconst LoadMoreData = async event => {\n    unsplashAPI.page += 1;\n\n    try {\n        const response = await unsplashAPI.fetchPhotosByQuery();\n\n        if (response.data.totalHits <= unsplashAPI.per_page*unsplashAPI.page) {\n\n            galleryEl.insertAdjacentHTML('beforeend', createGalleryCards(response.data.hits));\n\n            observer.unobserve(document.querySelector('.target-element'));\n\n            modalWindow();\n\n            Notiflix.Notify.info(\"We're sorry, but you've reached the end of search results.\", {\n            timeout: 3000,\n            }, );\n            return;\n        }\n        \n        galleryEl.insertAdjacentHTML('beforeend', createGalleryCards(response.data.hits));\n\n        modalWindow();\n\n        } catch(err) {\n        console.log(err);\n        };\n    };\n\nconst observer = new IntersectionObserver(\n    (entries, observer) => {\n        if (entries[0].isIntersecting) {\n        LoadMoreData();\n        }\n    },\n    {\n        root: null,\n        rootMargin: '600px',\n        threshold: 1,\n    }\n    );\n\nconst onSearchFormSubmit = async event => {\n    event.preventDefault();\n\n    unsplashAPI.query = userInput.value;\n    unsplashAPI.page = 1;\n\n    try { \n    const response = await unsplashAPI.fetchPhotosByQuery();\n\n      if (response.data.hits.length === 0) { //Якщо не коректний запрос повертаэться масив з length = 0, тоді очищаємо форму, ховаємо кнопку, очищуємо Input\n        \n        Notiflix.Notify.info(\"Sorry, there are no images matching your search query. Please try again.\");\n\n        galleryEl.innerHTML = ''; \n\n        observer.unobserve(document.querySelector('.target-element'));\n\n        event.target.reset();\n        return;\n        }\n\n        if(response.data.hits.length < unsplashAPI.per_page) {\n\n        galleryEl.innerHTML = createGalleryCards(response.data.hits);\n\n        modalWindow();\n\n        observer.unobserve(document.querySelector('.target-element'));\n\n        Notiflix.Notify.failure(\"We're sorry, but you've reached the end of search results.\", {\n            timeout: 3000,\n        });\n        return;\n        }\n\n        galleryEl.innerHTML = createGalleryCards(response.data.hits);\n\n        modalWindow();\n\n        observer.observe(document.querySelector('.target-element'));\n\n        Notiflix.Notify.success(`Hooray! We found ${response.data.totalHits} totalHits images.`, {\n        timeout: 3000,\n        },);\n\n    } catch(err) {\n        console.log(err);\n    };\n};\n\n\n\nconst modalWindow = function() {\n    const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 300,\n    });\n    return lightbox;\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n"],"names":["$bpxeT","parcelRequire","$3324a5547161cc80$var$searchFormEl","document","querySelector","$3324a5547161cc80$var$galleryEl","$3324a5547161cc80$var$userInput","$3324a5547161cc80$var$unsplashAPI","$dgVK0","UnsplashAPI","$3324a5547161cc80$var$LoadMoreData","$parcel$interopDefault","$2TvXO","mark","_callee","event","response","page","fetchPhotosByQuery","_ctx","sent","data","totalHits","per_page","insertAdjacentHTML","$86MAb","default","hits","$3324a5547161cc80$var$observer","unobserve","$3324a5547161cc80$var$modalWindow","$iU1Pc","Notify","info","timeout","console","log","t0","IntersectionObserver","entries","observer","isIntersecting","root","rootMargin","threshold","$3324a5547161cc80$var$onSearchFormSubmit","preventDefault","query","value","length","innerHTML","target","reset","failure","observe","success","concat","$5IjG7","captionsData","captionDelay","addEventListener"],"version":3,"file":"scroll-page.33a83ef7.js.map"}